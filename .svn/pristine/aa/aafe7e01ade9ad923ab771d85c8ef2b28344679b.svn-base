"use strict";(self["webpackChunknavy"]=self["webpackChunknavy"]||[]).push([[5023],{2982:(t,e,n)=>{n.d(e,{Z:()=>l});var i=n(66252);function a(t,e,n,a,o,r){const s=(0,i.up)("ion-spinner");return(0,i.wg)(),(0,i.j4)(s,{name:"lines"})}const o={name:"PageLoadingCheck"};var r=n(83744);const s=(0,r.Z)(o,[["render",a]]),l=s},45023:(t,e,n)=>{n.r(e),n.d(e,{default:()=>z});var i=n(66252),a=n(3577);const o=t=>((0,i.dD)("data-v-de034bae"),t=t(),(0,i.Cn)(),t),r=o((()=>(0,i._)("div",{id:"openchatMap",style:{width:"100%",height:"100%"}},null,-1))),s={class:"row-box"},l={class:"content"},d={class:"text-xl text-bold"},p={class:"text-md text-bold"},c={class:"row-box"},m={class:"row-box"};function u(t,e,n,o,u,h){const g=(0,i.up)("BackButton"),f=(0,i.up)("ion-buttons"),w=(0,i.up)("ion-title"),k=(0,i.up)("ion-toolbar"),b=(0,i.up)("ion-segment-button"),C=(0,i.up)("ion-segment"),L=(0,i.up)("ion-header"),x=(0,i.up)("PageLoadingCheck"),y=(0,i.up)("OpenChatMapUserInfo"),v=(0,i.up)("ion-icon"),I=(0,i.up)("ion-label"),M=(0,i.up)("ion-text"),P=(0,i.up)("ion-button"),_=(0,i.up)("CustomModalLayout"),z=(0,i.up)("ion-content"),U=(0,i.up)("ion-modal"),W=(0,i.up)("ion-page");return(0,i.wg)(),(0,i.j4)(W,null,{default:(0,i.w5)((()=>[(0,i.Wm)(L,null,{default:(0,i.w5)((()=>[(0,i.Wm)(k,null,{default:(0,i.w5)((()=>[(0,i.Wm)(f,{slot:"start"},{default:(0,i.w5)((()=>[(0,i.Wm)(g,{onEvent:h.goRouter,custom:!0},null,8,["onEvent"])])),_:1}),(0,i.Wm)(w,null,{default:(0,i.w5)((()=>[(0,i.Uk)("지도로 보기")])),_:1})])),_:1}),(0,i.Wm)(k,{class:"category-filter"},{default:(0,i.w5)((()=>[(0,i.Wm)(C,{modelValue:u.partitionCd,"onUpdate:modelValue":e[1]||(e[1]=t=>u.partitionCd=t),mode:"ios",scrollable:!0,class:"segment-chip"},{default:(0,i.w5)((()=>[(0,i.Wm)(b,{value:"",onClick:e[0]||(e[0]=t=>h.partitionBtn()),class:"shape-round"},{default:(0,i.w5)((()=>[(0,i.Uk)("전체 ")])),_:1}),((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(u.partitionList,(t=>((0,i.wg)(),(0,i.j4)(b,{disabled:!1,key:t.id,value:t.partitionCd,onClick:e=>h.partitionBtn(t),class:"shape-round"},{default:(0,i.w5)((()=>[(0,i.Uk)((0,a.zw)(t.partitionNm),1)])),_:2},1032,["value","onClick"])))),128))])),_:1},8,["modelValue"])])),_:1}),(0,i.Wm)(k,{class:"category-filter"},{default:(0,i.w5)((()=>[(0,i.Wm)(C,{modelValue:u.subPartitionCd,"onUpdate:modelValue":e[2]||(e[2]=t=>u.subPartitionCd=t),mode:"ios",scrollable:!0,value:"",class:"segment-chip"},{default:(0,i.w5)((()=>[(0,i.Wm)(b,{value:"",onClick:h.partitionSubBtn,class:"border-secondary"},{default:(0,i.w5)((()=>[(0,i.Uk)("전체 ")])),_:1},8,["onClick"]),""!=u.partitionCd?((0,i.wg)(!0),(0,i.iD)(i.HY,{key:0},(0,i.Ko)(u.partitionSubList,(t=>((0,i.wg)(),(0,i.j4)(b,{disabled:!1,key:t.id,value:t.subPartitionCd,class:"border-secondary",onClick:e=>h.partitionSubBtn(t)},{default:(0,i.w5)((()=>[(0,i.Uk)((0,a.zw)(t.subPartitionNm),1)])),_:2},1032,["value","onClick"])))),128)):(0,i.kq)("",!0),u.partitionSubList.length&&""!=u.partitionCd?(0,i.kq)("",!0):((0,i.wg)(),(0,i.iD)(i.HY,{key:1},(0,i.Ko)(10,((t,e)=>(0,i.Wm)(b,{key:e,class:"is-blind"}))),64))])),_:1},8,["modelValue"])])),_:1})])),_:1}),(0,i.Wm)(z,{fullscreen:!0},{default:(0,i.w5)((()=>[0==u.lodingCheck?((0,i.wg)(),(0,i.j4)(x,{key:0,style:{display:"flex","align-items":"center","justify-content":"center",margin:"0 auto",height:"100%"}})):(0,i.kq)("",!0),r,(0,i.Wm)(U,{"is-open":u.mapInfoModal,"handle-behavior":"cycle",onIonModalDidDismiss:e[5]||(e[5]=t=>u.mapInfoModal=!1),"initial-breakpoint":.95,breakpoints:[0,.15,.5,.95],class:"custom-modal bottom-modal"},{default:(0,i.w5)((()=>[(0,i.Wm)(z,null,{default:(0,i.w5)((()=>[(0,i.Wm)(_,null,{header:(0,i.w5)((()=>[(0,i.Wm)(y,{item:u.modalItem,thumbnail:u.cdnThumbNmProfile,onClick:e[3]||(e[3]=t=>h.modalBtn("openProfile",u.modalItem))},null,8,["item","thumbnail"])])),content:(0,i.w5)((()=>[(0,i._)("div",s,[(0,i._)("div",l,[(0,i._)("h5",d,(0,a.zw)(u.modalItem.title),1),(0,i._)("p",p,(0,a.zw)(u.modalItem.content),1)])])])),footer:(0,i.w5)((()=>[(0,i._)("div",c,[(0,i.Wm)(M,{color:"light",class:"text-sm"},{default:(0,i.w5)((()=>[(0,i.Wm)(v,{icon:u.locationOutline},null,8,["icon"]),(0,i.Wm)(I,null,{default:(0,i.w5)((()=>[(0,i._)("span",null,(0,a.zw)(u.modalItem.location),1)])),_:1})])),_:1})]),(0,i._)("div",m,[(0,i.Wm)(P,{onClick:e[4]||(e[4]=t=>h.modalBtn("openView",u.modalItem)),color:"primary",shape:"round",expand:"block",size:"large"},{default:(0,i.w5)((()=>[(0,i.Uk)(" 게시글 이동 ")])),_:1})])])),_:1})])),_:1})])),_:1},8,["is-open"])])),_:1})])),_:1})}n(57658);var h=n(18903),g=n(27783),f=n(28151);const w=["src"],k={key:0,style:{"font-size":"12px"}},b={key:1,style:{"font-size":"12px",color:"#f1f157"}};function C(t,e,o,r,s,l){const d=(0,i.up)("ion-avatar"),p=(0,i.up)("ion-text"),c=(0,i.up)("ion-label"),m=(0,i.up)("ion-item");return(0,i.wg)(),(0,i.j4)(m,{lines:"none"},{default:(0,i.w5)((()=>[(0,i.Wm)(d,{slot:"start"},{default:(0,i.w5)((()=>[(0,i._)("img",{src:"https://"+o.thumbnail,"on:ionError":e[0]||(e[0]=t=>t.srcElement.src=n(7189))},null,40,w)])),_:1}),(0,i.Wm)(c,{style:{display:"flex","justify-content":"space-between"}},{default:(0,i.w5)((()=>[(0,i.Wm)(p,{color:"light"},{default:(0,i.w5)((()=>[(0,i.Uk)((0,a.zw)(o.item.nick),1)])),_:1}),(0,i.Wm)(p,{color:"light"},{default:(0,i.w5)((()=>["방금 전"!=o.item.recentTime?((0,i.wg)(),(0,i.iD)("span",k," 방장이 "+(0,a.zw)(o.item.recentTime)+" 마지막으로 활동했습니다. ",1)):((0,i.wg)(),(0,i.iD)("span",b," 방장이 현재 활동 중 입니다 "))])),_:1})])),_:1})])),_:1})}const L={name:"OpenChatMapUserInfo",props:{item:{type:String},thumbnail:{type:String}},methods:{}};var x=n(83744);const y=(0,x.Z)(L,[["render",C],["__scopeId","data-v-a4c010ac"]]),v=y;var I=n(2982),M=n(54652);const P={name:"OpenChatMap",components:{OpenChatMapUserInfo:v,PageLoadingCheck:I.Z},data(){return{locationOutline:h.Iv7,search:h.yC4,itemList:[],map:null,addrItem:"",currLat:"",currLon:"",mapInfoModal:!1,modalItem:"",loading:null,partitionCd:"",partitionList:[],subPartitionCd:"",partitionSubList:[{id:1,subPartitionCd:"allTime",subPartitionNm:"상시 모집"},{id:2,subPartitionCd:"today",subPartitionNm:"오늘"},{id:3,subPartitionCd:"tomorrow",subPartitionNm:"내일"},{id:4,subPartitionCd:"week",subPartitionNm:"이번주"},{id:5,subPartitionCd:"month",subPartitionNm:"이번달"}],mainFileId:"",regUserKey:"",userPhotoId:"",isEndScroll:!1,ssUserYn:"",attendYn:"",attendChk:"",inviteYn:"",attendRegTime:"",modalHeight:"500px",intervalId:null,selectedLat:null,selectedLng:null,cdnThumbNmProfile:"",lodingCheck:!1,markers:[],htmlMarker1:{content:"<div class='marker' style='display: flex; align-items: center; justify-content: center; background-color: #191A37; color: #fff; font-size: 20px; font-weight: 700; box-shadow: 6px 6px 10px rgba(color: #000000, alpha: 0.16);'></div>",size:window.naver.maps.Size(40,40),anchor:window.naver.maps.Point(20,20)},htmlMarker2:{content:"<div class='marker' style='display: flex; align-items: center; justify-content: center; background-color: #191A37; color: #fff; font-size: 20px; font-weight: 700; box-shadow: 6px 6px 10px rgba(color: #000000, alpha: 0.16);'></div>",size:window.naver.maps.Size(40,40),anchor:window.naver.maps.Point(20,20)},htmlMarker3:{content:"<div class='marker' style='display: flex; align-items: center; justify-content: center; background-color: #191A37; color: #fff; font-size: 20px; font-weight: 700; box-shadow: 6px 6px 10px rgba(color: #000000, alpha: 0.16);'></div>",size:window.naver.maps.Size(40,40),anchor:window.naver.maps.Point(20,20)},htmlMarker4:{content:"<div class='marker' style='display: flex; align-items: center; justify-content: center; background-color: #191A37; color: #fff; font-size: 20px; font-weight: 700; box-shadow: 6px 6px 10px rgba(color: #000000, alpha: 0.16);'></div>",size:window.naver.maps.Size(40,40),anchor:window.naver.maps.Point(20,20)},htmlMarker5:{content:"<div class='marker' style='display: flex; align-items: center; justify-content: center; background-color: #191A37; color: #fff; font-size: 20px; font-weight: 700; box-shadow: 6px 6px 10px rgba(color: #000000, alpha: 0.16);'></div>",size:window.naver.maps.Size(40,40),anchor:window.naver.maps.Point(20,20)}}},ionViewWillEnter(){this.lodingCheck=!1,this.addrItem="",this.currLat="",this.currLon="",this.getLoginUser(),this.getPartitionList()},ionViewDidLeave(){window.naver.maps.Event.clearInstanceListeners(this.map),this.map=null,this.markers=[],this.partitionCd="",this.partitionList=[],this.subPartitionCd="",document.getElementById("openchatMap").replaceChildren()},methods:{getRecentDate(t){const e=new Date,n=new Date(t),i=Math.floor((e.getTime()-n.getTime())/1e3/60);if(i<1)return"방금 전";if(i<60)return`${i}분 전`;const a=Math.floor(i/60);if(a<24)return`${a}시간 전`;const o=Math.floor(i/60/24);return o<365?`${o}일 전`:`${Math.floor(o/365)}년 전`},partitionBtn(t){this.itemList=[],this.partitionCd="",this.subPartitionCd="",this.partitionCd=t?t["partitionCd"]:"",this.$nextTick((()=>{""!=this.subPartitionCd&&(this.subPartitionCd=""),this.getOpenChatLatLon(this.currLat,this.currLon)}))},partitionSubBtn(t){this.itemList=[],this.subPartitionCd=t?t["subPartitionCd"]:"",this.$nextTick((()=>{this.getOpenChatLatLon(this.currLat,this.currLon)}))},getPartitionList(){(0,f.Yu)({url:"/getPartitionList",param:{},then:t=>{this.partitionList=t,this.$nextTick((()=>{this.getOpenChatLatLon(this.currLat,this.currLon)}))}})},goRouter(){this.$router.push("/openChat")},getLoginUser(){(0,f.Yu)({url:"/getOpenChatUserAddr",param:{},then:t=>{this.addrItem=t[0],null!=this.addrItem.currLat||null!=this.addrItem.currLon?(this.currLat=this.addrItem.currLat,this.currLon=this.addrItem.currLon):(this.currLat=this.addrItem.lat,this.currLon=this.addrItem.lon)}})},getOpenChatLatLon(t,e,n){(0,f.Yu)({url:"/getOpenChatLatLon",param:{partitionCd:this.partitionCd,subPartitionCd:this.subPartitionCd,mapLat:t,mapLon:e,zoomSize:n||""},then:t=>{this.itemList=t,this.lodingCheck=!0,this.$nextTick((()=>{this.naverMap(this.currLat,this.currLon)}))}})},modalBtn(t,e){"openView"==t?((0,f.pR)({openChatKey:e.openChatKey,type:"openChatMap",modal:"open",mpaInfo:e}),this.$router.push("/openChatView"),this.mapInfoModal=!1):"openProfile"==t&&((0,f.PC)({userKey:e.regUserKey,type:"openChatMap"}),this.$router.push("/dailyCardInfo"),this.mapInfoModal=!1)},modalInfo(t){this.modalItem=t,this.modalItem.ssUserYn=t.ssUserKey==t.regUserKey?"Y":"N",this.modalItem.inviteYn="N"==t.attenderCancelYn?"Y":"N",this.regUserKey=this.modalItem.regUserKey,this.mainFileId=this.modalItem.fileId,this.mapInfoModal=!0,this.$nextTick((()=>{this.getUserInfo()}))},getUserInfo(){(0,f.Yu)({url:"/getUserInfo",param:{regUserKey:this.regUserKey},then:t=>{this.userPhotoId=t.userPhotoId,this.cdnThumbNmProfile=t.cdnThumbNm}})},naverMap(t,e){let n=this;const i=window.naver.maps;let a={center:new i.LatLng(t,e),zoom:null!=this.map?this.map.getZoom():15,zoomControl:!0,zoomControlOptions:{style:i.ZoomControlStyle.LARGE,position:i.Position.TOP_RIGHT}};document.getElementById("openchatMap").replaceChildren(),this.map=new i.Map("openchatMap",a),i.Event.once(this.map,"init",(()=>{let a='<a style="\n                z-index: 100;\n                overflow: hidden;\n                display: inline-block;\n                position: absolute;\n                top: 7px;\n                left: 5px;\n                width: 34px;\n                height: 34px;\n                border: 1px solid rgba(58,70,88,.45);\n                border-radius: 2px;\n                background: #fcfcfd;\n                  background-clip: border-box;\n                text-align: center;\n                -webkit-background-clip: padding;\n                background-clip: padding-box;\n              "\n            >\n            <span style="\n                overflow: hidden;\n                display: inline-block;\n                color: transparent !important;\n                vertical-align: top;\n                background: url(https://ssl.pstatic.net/static/maps/m/spr_trff_v6.png) 0 0;\n                background-position-x: 0px;\n                background-position-y: 0px;\n                background-size: auto;\n                background-size: 200px 200px;\n                -webkit-background-size: 200px 200px;\n                width: 20px;\n                height: 20px;\n                margin: 7px 0 0 0;\n                background-position: -153px -31px;\n              ">중심위치</span>\n           </a>',o=new i.CustomControl(a,{position:i.Position.TOP_LEFT});o.setMap(n.map),i.Event.addDOMListener(o.getElement(),"click",(()=>{n.map.setCenter(new i.LatLng(t,e))}))})),this.clearMarker(),this.markers=[],this.itemList.forEach((t=>{Object.keys(t.recentTime).length>0&&(t.recentTime=this.getRecentDate(t.recentTime));const e=new i.LatLng(t.lat,t.lon),a=new i.Marker({position:e,map:n.map,icon:{content:`<div class="marker"><img src="https://${t.cdnThumbNm}" /></div>`,size:new i.Size(60,60),scaledSize:new i.Size(60,60),origin:new i.Point(0,0),anchor:new i.Point(12,37)},title:t.title});i.Event.addListener(a,"click",(()=>{this.modalInfo(t)})),this.markers.push(a)})),i.Event.addListener(n.map,"zoom_changed",(function(){n.updateMarkers()})),i.Event.addListener(n.map,"dragend",(function(){n.updateMarkers()}));new M.P({minClusterSize:2,maxZoom:16,map:n.map,markers:n.markers,disableClickZoom:!1,gridSize:50,icons:[n.htmlMarker1,n.htmlMarker2,n.htmlMarker3,n.htmlMarker4,n.htmlMarker5],stylingFunction:function(t,e){const n=t.getElement().children[0];n.innerHTML=e}})},async showLoading(){this.loading=await g.G0.create({message:"Loading...",duration:0}),await this.loading.present()},updateMarkers(){this.currLat=this.map.getCenter().y,this.currLon=this.map.getCenter().x,this.getOpenChatLatLon(this.currLat,this.currLon,this.map.zoom)},showMarker(t){t.setMap()||t.setMap(this.map)},hideMarker(t){t.setMap()&&t.setMap(null)},clearMarker(){for(let t=0;t<this.markers.length;t++)this.markers[t].setMap(null)}},mounted(){}},_=(0,x.Z)(P,[["render",u],["__scopeId","data-v-de034bae"]]),z=_}}]);
//# sourceMappingURL=5023-legacy.44912653.js.map